保障维度	实现方式	优势
状态一致性	保存 所有数据处理完成后的最终状态	✅ 无 in-flight 数据
数据完整性	Source 停止前提交最后 Offset	✅ 不丢数据
数据不重	数据处理完成后才做快照，Sink 无需额外机制	✅ 天然避免重复
精确一次范围	天然支持端到端 Exactly-Once	无需依赖 Sink 特性


此方案通过 "排空管道" 机制，在停止前确保：

所有输入数据被完全处理

所有结果写入外部系统

状态与输出完全对齐
是真正的 "零数据丢失、零重复" 方案
