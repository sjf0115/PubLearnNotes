
### 1. 为什么分层

数据仓库同学在设计数仓分层时首先要问一下自己：为什么要分层，不分层不可以吗？作为一名数据仓库研发同学，我们肯定希望自己的数据能够有秩序地流转，整个数据体系清晰有序。然而，在大多数情况下，我们的数据体系却是关系复杂混乱的。因此，我们需要一套行之有效的数据组织和管理方法来让我们的数据体系更有序，更加清晰。数据分层就是其中的一个手段，数据分层并不能解决所有的数据问题，但却可以给我们带来如下的好处：
- 复杂问题简单化：简化数据清洗过程，将原来一步的复杂任务分解成多步来完成，相当于把一个复杂的工作拆成了多个简单的工作。每一层的处理逻辑变的相对简单、更容易理解，也更容易保证处理的正确性。同时对于数据的运维以及出现问题之后的定位也更加容易。
- 职责清晰：每一个数据分层都有它的作用域，这样我们在使用表的时候能更方便地定位和理解。
- 减少重复开发：规范数据分层，开发一些通用的中间层数据，能够减少极大的重复计算。
- 统一数据口径：通过数据分层，提供统一的数据出口，统一输出口径。
- 屏蔽原始数据的异常：原始数据的异常对下游使用方透明。
- 屏蔽业务的影响：不必改一次业务就需要重新接入数据。

数据分层不是一种强制性约束：即使没有数据分层，也照样可以获得我们想要的数据。数据分层是一种优化手段：在数据分层的加持下数据体系流转也会更加清晰有序，大大提升数据仓库同学研发效率以及降低运维成本。

数仓层内部的划分不是为了分层而分层，分层是为了解决数据 任务及工作流的组织、数据的流向、读写权限的控制、不同需求的满足等各类问题。对于上面分层罗列，是种通用的建设分层逻辑。可能你也看到有四层的，有六层的，甚至更多的，比如DWD，DWB，DIM,DWM,MID......虽然每层你知道什么意思，但是有时候不是很清楚这些层之间的分割线是什么，出现复杂的业务反而让我们无法下手。所以各个业务不同，需要合适自己的就好。

### 2. 分层

我们将数据模型分为三层：操作数据层 ODS、公共维度模型层 CDM 以及应用数据层 ADS。公共维度模型层 CDM 又分为明细数据层的 DWD 和汇总数据层 DWS。


如下图所示。简单来讲，我们可以理解为：**ODS层存放的是接入的原始数据，DW层是存放我们要重点设计的数据仓库中间层数据，APP是面向业务定制的应用数据。**下面详细介绍这三层的设计。


dwd
- 清洗；重复；异常值；非业务需要；
- 业务口径统一 上层场景统计不受变化影响。
- 字段统一化
- 公共逻辑处理
- 异常数据处理 统一规则
- 解析与结构化
- 合并相似数据
- 关联相似数据

dwm
- 明细数据


版本协议：
分模块切换/整体切换


数据消费：
- 数据服务
- 报表平台












dd
